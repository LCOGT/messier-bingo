{% load staticfiles %}
<!DOCTYPE html>
<html>
<head>
	<title>Messier Bingo</title>
	<meta http-equiv="X-UA-Compatible" content="chrome=IE9">
	<link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/font-awesome/4.4.0/css/font-awesome.min.css">
	<link rel="stylesheet" href="{% static 'css/mb-style.css' %}" type="text/css">
	<!--[if lt IE 9]><link rel="stylesheet" href="{% static 'css/mb-style-ie.css'%}" type="text/css" /><![endif]-->
	{% block scripts %}
	<script language="javascript" type="text/javascript" src="{% static 'js/jquery-1.10.0.min.js' %}"></script>
	<!-- Use jQuery UI for better easing in animations -->
	<!--<script language="javascript" type="text/javascript" src="js/jquery-ui-1.10.3.custom.min.js"></script>-->
	<script language="javascript" type="text/javascript" src="{% static 'js/raphael-min.js' %}"></script>
	<!--<script language="javascript" type="text/javascript" src="js/jquery.queryloader2.js"></script>-->
	<script language="javascript" type="text/javascript" src="{% static 'js/messier.js' %}"></script>
	{% endblock%}
	{% block scripts-extra %}
	<script type="text/javascript">
			$(document).ready(function(){
				
				{% if request.user.is_authenticated %}
				$(document).on('click','#observe_button',function(event){
					console.log('observe-confirm');
					var content = $('#observe-confirm').html()
					$('#message-content').html(content);
					showPopup();
				});	
				{% endif %}

				$(document).on('click','#togglepopup',function(event){
					var content = $('#login-form').html()
					$('#message-content').html(content);
					showPopup();

				});

				$(document).on('click','#make-request',function(event){
					var content = '<div style="margin:1em;"><i class="fa fa-spinner fa-spin fa-3x fa-fw margin-bottom"></i><br />Sending your request to Serol...<\/div>'
					$('#message-content').html(content);
					mb.submit_schedule('{{ csrf_token }}');
				});



				function showPopup(){ 
					if ($('#message-popup').is(':visible')) $('#message-popup').fadeOut("fast");
					else $('#message-popup').fadeIn("fast");
					$('#message-popup-close').bind("click",function(){ closePopup();});
					$('.overlay').show();
					return false;
				}
				centreDiv = function(el){
					var wide = $(window).width();
					var tall = $(window).height();
					$(el).css({left:(wide-$(el).outerWidth())/2,top:($(window).scrollTop()+(tall-$(el).outerHeight())/2)});
				}
			});
			function closePopup(delay){
				$('#message-popup').delay(delay).fadeOut("fast");
				$('.overlay').hide();
			}
	</script>
	{% endblock %}
</head>
<body class="{%block body-class%}{% endblock%}">
  <div class="overlay"  style="display:none;"></div>
	<div id="header-holder">
		<div id="lcogt-bar">
			{% block login %}
			<div id="login" class="block">
				<ul>
					{% if user.is_authenticated %}
					<li>
						<a href="#" id="messages-inbox" class="fa fa-inbox{% if messages %} highlight{% endif %}"></a>
					</li>
					<li>
						{% if user.first_name %}{{ user.first_name }}{% else %}{{user.username}}{% endif %}
					</li>
					<li>
						<a target="_parent" href="{% url 'auth_logout' as logouturl %}{{ logouturl }}"> Logout</a>
					</li>
					{% else %}
					<li>
						<a href="#" id="togglepopup">Login</a>
					</li>
					{% endif %}
				</ul>
			</div>
			{% endblock %}
			<div id="lcogt-name">
				<a target="_parent" href="http://lcogt.net/" title="LCOGT Homepage"><span class="l">L</span><span class="wide">as </span><span class="c">C</span><span class="wide">umbres </span><span class="o">O</span><span class="wide">bservatory </span><span class="g">G</span><span class="wide">lobal </span><span class="t">T</span><span class="wide">elescope Network</span></a>
			</div>
		</div>
	</div>
	{% block main-content %}
	<div id="loader" class=""></div>

	<div id="outer">
		<div id="container">
			<div id="paper"></div>
			<div id="title"><h1>Messier Bingo</h1></div>
			<div id="nametoggle"><a href="#messier">Charles Messier</a></div>
			<div id="messier" class="panel"><div class="content"><div class="inner"><div class="padded"><p><a href="https://en.wikipedia.org/wiki/Charles_Messier" target="messier">Charles Messier</a> was born in 1730 and his interest in astronomy was sparked by a spectacular, six-tailed comet when he was 14.</p><p>He moved to Paris and wanted to become famous by discovering comets. When he looked through his telescope he often re-discovered objects which were already known and were not comets. To make sure he didn't waste time, each time he found an object that did not move in the sky he catalogued it. His famous list contains 110 objects.</p></div></div></div></div>
			<div id="panel" class="panel">
				<div class="content">
					<div class="inner">
						<div class="padded" id="panel-info">
							<h3>Instructions</h3>
							<p>Get your <a href="http://lcogt.net/education/messierbingo">bingo card</a> and mark it each time one of your objects appears.</p>
							<p>When you have marked all the objects on your card shout 'Bingo', 'House' or even 'Messier' to win.</p>
							<p>To select a new Messier object press the arrow in the bottom right. If you need to restart press the 'R' key.</p>
						</div>
						<div class="padded" id="observe_button" style="display:none;">
							<a href="#" class="btn" id="request-popup">Take your own picture! ></a>
						</div>
					</div>
				</div>
			</div>
			<div id="sky"><img src="{% static 'images/iris.png' %}" /></div>
			<div id="glass"><img src="{% static 'images/glass2.png' %}" /></div>
			<div id="glass-small"><img src="{% static 'images/glass2.png' %}" /></div>
				<!--<div id="portalinner"></div>-->
		</div>	
	</div>
	<div id="message-popup" style="display:none;">
		<div id="show-messages-inner">
			<div id="message-popup-close">Ã—</div>
			<div id="message-content"></div>
		</div>
	</div>
	<div id="login-form"  style="display:none;">
		<form action="{% url 'auth_login' %}" method="post">
			{% csrf_token %}
		 	{{login_form}}
			<div class="submit-row">
		    	<label>&nbsp;</label><input type="submit" value="Log in">
		  	</div>
		</form>
	</div>
	<div id="observe-confirm"  style="display:none;">
		<h3>Observe <span id="object-name"></span></h3>
		<p>Do you want an image of <strong><span id="object-name"></span></strong> to be taken in the next week by LCOGT?</p>
		<p><a href="#" data-objectid="" id="make-request" class="btn">Yes Please!</a> or <a href="#" onclick="closePopup();">No Thanks</a></p>
	</div>
	{% endblock %}
</body>
</html>
